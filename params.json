{"name":"Snebu","tagline":"Simple Network Backup Utility","body":"Introduction\r\n====\r\n\r\nSnebu is an efficient incremental snapshot style client/server disk-based backup system for Unix / Linux systems.  Efficiency is provided by transferring only the needed files to complete a given backup set, along with compression and file-level de-duplication.  This de-duplication is effective for any files with the same contents, whether they come from the same backup instance, or are duplicated across past backups, or even across  multiple systems.  Therefore you can backup the full OS on multiple servers using only minimal additional storage space.\r\n\r\nAudience\r\n----\r\n\r\nSnebu is for those who either have no current backup strategy, and want to get something going quickly (either to a locally attached external drive, or to some storage on another server), or if you are currently using a simpler backup scheme (such as one of the rsync-based backup methods) and need to have some of the features of the more heavy weight backup systems (such as a compression, de-duplication, backup catalog DB, and scheduled data expiration).\r\n\r\nFeatures\r\n====\r\n\r\nBenefits:\r\n\r\n* Easy to set up  \r\n  There system consists of two programs:  \r\n  `snebu-client` - This is a simple shell script for interacting with the backend process, along with gathering   the files to include in a given backup set.  \r\n  `snebu` -- This is the backend process which stores backup files in a disk-based vault, maintaining metadata    about the files and backup sets in an SQLite-based backup catalog.\r\n\r\n  There are no complicated daemons to configure, or heavy database systems that need to be installed.  All the core logic is self-contained in the snebu binary.\r\n\r\n* Suitable for backing up a single system to an attached external disk, backing up to a separate network server,  or backing up a number of hosts with backups initiated from the central backup server.\r\n\r\n* No client software installation required.  If backups are initiated from a central backup server, then          communications to the clients are preformed over SSH.  The only requirements are that the backup account on the   server is permitted appropriate access to the client (via ssh keys), and the client have the minimal versions of  GNU find and tar installed (this is only a concern with ancient Linux installations, or Unix systems).\r\n\r\n* Works similar to rsync-based backup tools (by providing snapshot incremental-forever backups), but provides     compression and a self-contained database-backed (SQLite) backup catalog.  One of the many benefits of having a   separate backup catalog is this allows the backend to execute under a regular (non-root) utility account.\r\n\r\n* File-level de-duplication is supported, including de-duplication of files across backup sets, and across        multiple backup clients.\r\n\r\n* Built using standard tools and protocols.  File metadata gathering is provided by the \"find\" command (GNU find  is required), files are transfered using \"tar\" format, the backup catalog is in an SQLite database file, and      files are stored in the disk-based vault compressed with the LZO library, and compatible with the \"lzop\"          compression program.\r\n\r\n\r\nQuick-start guide\r\n====\r\n\r\nConcepts\r\n----\r\n\r\nThe Snebu backup system is composed of a backend process, `snebu`, and a front-end client called `snebu-client`.  The client gathers a list of files to back up (using the `find` command), sends this list to the backend, and gets back a list of files that are needed to complete an incremental backup.  These files are then sent to the backend using the Unix `tar` format.\r\n\r\nBackups are stored in backup sets.  A backup set is uniquely identified by the backup name (typically the host name getting backed up), and a datestamp in the form of a Unix time_t value (essentially, a count of the number of seconds since Jan 1, 1970).  This value functions as a serial number.\r\n\r\nEach backup set has a retention schedule attached to it, specified by the `-r` flag.  The retention schedule is used by the expiration process to, for example, expire all daily backups older than 10 days, or all monthly backups older than 6 months.  Anything can be used for for a schedule name, but typical values are `daily`, `weekly`, `monthly`, `yearly`, and `archive`.  If not specified, then the `snebu-client` script will automatically pick a retention schedule based on the date (Sunday through Friday are daily, Saturday is weekly, and the 1st of the month is monthly).\r\n\r\nWhen a backup is requested, the backend will determine which files it already has (by comparing meta data such as file name, size, last modification time, and various other attributes).  A list of files that are already on the backup server is added to the current backup set.  The remaining files are then requested, and are added to the backup set when they are received.\r\n\r\nFile contents are stored and referenced by using the SHA1 hash of the file contents.  Therefore, file level de-duplication is achieved across all backups stored on the backup server.  In addition, files are stored compressed in an lzop compatible format.  This allows for recovery of files even outside of the backup utility.\r\n\r\nSetting up a local backup\r\n----\r\n\r\nThis procedure assumes that both `snebu` and `snebu-client` are installed, and you will be backing up to a drive that is mounted under /media/backups.  These steps will be run as the root user.  In the examples, the host name that is getting backed up is called `zeus`  The backup retention schedules are automatically determined in these examples (use `-r` to override)\r\n\r\n1) Create a file `/etc/snebu.conf` with the following:\r\n\r\n    meta=/media/backups/meta\r\n    vault=/media/backups/vault\r\n\r\nThe meta directory is where the backup catalog is stored (in an SQLite DB).  The vault directory contains all the backup file contents.\r\n\r\n2) Create the directories from the previous step:\r\n\r\n    mkdir -p /media/backups/meta\r\n    mkdir -p /media/backups/vault\r\n\r\n3) Create a file `/etc/snebu-client.conf` with the following:\r\n\r\n    EXCLUDE=( /tmp /var/tmp /mnt /media/backups )\r\n\r\nBy default, the files to be backed up included all mounted Linux filesystems of the types ext2, ext3, ext4, btrfs, xfs.  This is the same as specifying the following line in the `snebu-client.conf` file:\r\n\r\n    INCLUDE=( $(mount |egrep \"ext[234]|btrfs\" |awk '{print $3}') )\r\n\r\nIf you want to list specific directories to backup, list them in an INCLUDE line in the `/etc/snebu-client.conf` file:\r\n\r\n    INCLUDE=( /dir1 /dir2 /dir3 )\r\n\r\nOr, if you want to add to the default include:\r\n\r\n    INCLUDE=( \"${INCLUDE[@]}\" /dir1 /dir2 /dir3 )\r\n\r\n4) Run a test backup:\r\n\r\n    snebu-client backup -v\r\n\r\nNote, you can also override the default INCLUDE list on the `snebu-client` command line:\r\n\r\n    snebu-client backup -v /dir1 /dir2\r\n\r\nSee the `snebu-client` detailed documentation for the list of available parameters.  Specifically, look at the `-r` (retention schedule), and `-n` (backup name) parameters.\r\n\r\n5) Once the backup is completed, you can use the following to list the backups:\r\n\r\n    snebu-client listbackups -v\r\n\r\nWhich should output the names of the backups that are available:\r\n\r\n    zeus\r\n        1389677695 / daily / Mon Jan 13 23:34:55 2014\r\n\r\n7) To get a list of files that are included:\r\n\r\n    snebu-client listbackups --name zeus --datestamp 1389677695 |more\r\n\r\n8) To restore a given file, pick one from the list generated in the step above, and:\r\n\r\n    snebu-client restore --name zeus --datestamp 1389677695 '/path/to/file'\r\n\r\nOr, to restore a directory,\r\n\r\n    snebu-client restore --name zeus --datestamp 1389677695 '/path/to/directory/*'\r\n\r\nThis will by default place the files starting in the directory you are currently sitting in.  So, if you are in /tmp, and restore /home/bob/resume.txt, it will be placed in /tmp/home/bob/resume.txt.  See the detailed documentation section for additional parameters, such as `-C` which will specify an alternate target directory, or `--graft` which will allow you to rename parts of the file path.\r\n\r\n\r\nBacking up to a remote server\r\n----\r\n\r\nWhen backing up to a remote server, it is preferable to use a non-privliged user account, such as `backup`, instead of `root`.  In this section, the backup server will be called `jupiter`, and the client is `zeus`.  The backup server will have the target backup media mounted under /media/backups, which will be owned by `backup`.  The program `snebu` is assumed to be installed on `jupiter`, and the `snebu-client` script is on the client `zeus`.\r\n\r\n1) Create a backup user:\r\n\r\n    useradd backup\r\n    passwd backup\r\n\r\n2) Create a file `/etc/snebu.conf` with the following:\r\n\r\n    meta=/media/backups/meta\r\n    vault=/media/backups/vault\r\n\r\n3) After mounting the backup media, create the directories from the previous step, and make everything owned by backup:\r\n\r\n    mkdir -p /media/backups/meta\r\n    mkdir -p /media/backups/vault\r\n    chown -R backup /media/backups\r\n\r\n4) On the client (`zeus`), create an ssh key pair if one doesn't exist for the root user, and copy it to the `backup` user's authorized-keys file on `jupiter`:\r\n\r\n    ssh-keygen -t rsa -N \"\"\r\n    ssh-copy-id backup@jupiter\r\n\r\n5) On the client, create the `/etc/snebu-client.conf` file with proper INCLUDE and EXCLUDE parameters, as specified in the previous (local backup) section.\r\n\r\n6) Make sure you can (as root on `zeus`) ssh into the backup user on `jupiter`\r\n\r\n    ssh backup@jupiter uname -a\r\n\r\n7) Run a test backup as before, but with an additional parameter:\r\n\r\n    snebu-client backup --backup-server jupiter -v\r\n\r\nThe --backup-server parameter will also apply to all the other comands, such as listbackups and restore.  An alternative to specifying this each time is to add the following to `/etc/snebu-client.conf`:\r\n\r\n    bksvrname=jupiter\r\n\r\n\r\nBacking up remote clients from a backup server\r\n----\r\n\r\nIf you have a number of systems to back up, it may be better to initiate all backups from the backup server.  In this model, the `backup` user account on the backup server will need SSH permissions to access root on the clients.  This may be preferable, as it avoids having to give each client remote access to the backup server.  However, that means the clients have to trust the backup server with root access.  The good part, though, is there is nothing to install on the clients, other than inserting a key into root's authorized_keys file.\r\n\r\n1) Set up the backup server, `jupiter` as discussed in the previous section (steps 1 through 3)\r\n\r\n2) Also, on the server (`jupiter`), create an SSH key pair for the `backup` user\r\n\r\n    ssh-keygen -t rsa -N \"\"\r\n\r\n3) Copy the public key file to the clients to be backed up.  Newer versions of OpenSSH include a utility to make this easier:\r\n\r\n    ssh-copy-id root@zeus\r\n\r\n4) Initiate a test backup from the `backup` user on `jupiter`:\r\n\r\n    snebu-client backup --remote-client zeus -v\r\n\r\n\r\nDaily and periodic maintenance tasks\r\n----\r\n\r\n### Expiring old backups\r\n\r\nPeriodically cleaning out old backups is essential for keeping the target storage device from running out of space.  Typical data retention schedules are:\r\n\r\n* daily -- keep all daily backups for 2 weeks\r\n* weekly -- keep all weekly (Saturday) backups for 6 weeks\r\n* monthly -- keep all monthly backups for 12 months\r\n\r\nTo accomplish this, run the following commands on the backup server:\r\n\r\n    snebu expire -a 14 -r daily\r\n    snebu expire -a 42 -r weekly\r\n    snebu expire -a 365 -r monthly\r\n\r\nNote, that there is a safety valve built into the expire command, where it will keep (by default) the most recent 3 backup sets for a given system.  This can be adjusted with the `-m` flag (i.e., `-m 7` will keep the most recent 7 backups, or `-m 0` disables this safety check).\r\n\r\nAnother form of the expire command will remove a given backup set, useful if you have a partial or a redundant backup that needs to be cleaned out:\r\n\r\n    snebu expire -n name -d datestamp\r\n\r\nAfter the expiration jobs are finished (which removes the backups from the backup catalog), you will need to remove the actual file contents from the vault:\r\n\r\n    snebu purge\r\n\r\nThe purge process can take some time to execute, so typically it would be run on a weekly basis, and the expire jobs run daily after the backups have completed.\r\n\r\n\r\nAdvanced usage\r\n====\r\n\r\nCreating a custom snebu-client script\r\n----\r\n\r\nTypically, direct usage of the `snebu` command is used for maintenance purposes.  Submitting backups and restoring is driven by the snebu-client command.  However, if needed, you can create a custom client for advanced purposes (such as performing live database backups, which typically involve placing the DB in backup mode, and querying the DB for which files to back up).  The process of submitting a backup requires two parts:\r\n\r\n* snebu newbackup  \r\n  This subcommand expects an input list of files as a tab-delimited list consisting of:  \r\n    File Type, Mode, Device, Inode, Owner, Owner#, Group, Group#, Size, SHA1, Inode Mod Time, File Mod Date, Filename, Symlink Target\r\n\r\n  This list can be generated with GNU find command, with the following `-printf` arguments added:\r\n\r\n        \\( -type f -o -type d \\) \\\r\n            -printf \"%y\\t%#m\\t%D\\t%i\\t%u\\t%U\\t%g\\t%G\\t%s\\t0\\t%C@\\t%T@\\t%p\\0\" \\\r\n            -o -type l \\\r\n            -printf \"%y\\t%#m\\t%D\\t%i\\t%u\\t%U\\t%g\\t%G\\t%s\\t0\\t%C@\\t%T@\\t%p\\0%l\\0\"\r\n\r\n  (Note, that currently the SHA1 field (field number 10) isn't used, so the above puts a 0 as a placeholder.  This is intended to be an additional indicator of if a file needs to be transfered to the backup server's vault, or if it is already there.)\r\n\r\n* snebu submitfiles  \r\n  The output of the `snebu newbackup` command is a list of files that need to be backed up to complete the backup set (anything not on this list is already on the backup server, and gets linked to the current backup set).  This list is then used to generate a `tar` file, which gets submitted to the submitfiles target as standard input.\r\n\r\nSee the detailed documentation section for additional command line arguments that are required.  Also, the included snebu-client shell script can be referenced for more details.\r\n\r\n\r\nChanging file locations\r\n----\r\n\r\nOne parameter to `snebu-client` (or `snebu`, if writing your own client) is the `--graft` option.  This allows you to re-write the directory path from one location to another.  This is useful when backing up a filesystem snapshot.  If the snapshot of `/srv/database` is mounted under `/mnt/snapshots/database`, you can specify `--graft /mnt/snapshots/database/=/srv/database/` so that the backup will record the file locations as if they were backed up under their original location.\r\n\r\nAnother usage for `--graft` is when restoring a single file to a different location.  For example: `--graft /home/bob/budget.doc=/home/bob/restore/budget.doc` will allow restoring the file without overwriting the version that is currently in place.\r\n\r\n\r\nForcing a full backup\r\n----\r\n\r\nSnebu uses the file meta data (file name, last mod date, size, permissions, etc.) to determine if a file has been modified since the last backup.  If a file gets modified, keeps the same size, and the mod date is manually set to the original, this can cause the file to be skipped during incremental backups.  Therefore, it may be desirable to periodically force a full backup with the `-f` flag.  This will cause all included files to get transfered, although de-duplication is still accomplished on the back end.  The main drawback of `-f` is that it increases the backup time and network usage.\r\n\r\n\r\nPlugins\r\n----\r\n\r\nA plugin architecture is currently under development, which allows the `snebu-client` script to perform additional steps before and after a backup.  This can be used to create and mount snapshots of file systems, or to put a database into backup mode.\r\n\r\nCommand reference\r\n====\r\n\r\nsnebu-client\r\n----\r\n    Usage: snebu-client [ subcommand ] [ options ]\r\n     snebu-client is the client front end for snebu.  Use it to easily\r\n     back up a local or remote host, to either local a local storage\r\n     device, or to a remote backup server.  Use it with one of the\r\n     following subcommands.\r\n    \r\n     Sub commands are as follows:\r\n        backup  [ -n backupname ] [ -d datestamp ] [ -r schedule ]\r\n    \r\n        restore [ -n backupname ] [ -d datestamp ]\r\n    \r\n        listbackups [ -n backupname [ -d datestamp ]] [ file_list... ]\r\n    \r\n        help [subcommand]\r\n\r\n### snebu-client backup\r\n    Usage: snebu-client backup [ -n backupname ] [ -d datestamp ] [ -r schedule ]\r\n        [ file-list ]\r\n     Initiates a system backup.  By default, it will back up the local\r\n     host to a local snebu install.  You can also use this command to back\r\n     up to a remote backup server, back up a remote host to either a local\r\n     snebu instalation, or back up a remote host to another remote backup\r\n     server, depending on which options are chosen.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu-client.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n    \r\n     -r, --retention schedule   Retention schedule for this backup set.  Typical\r\n                                values are \"daily\", \"weekly\", \"monthly\", \"yearly\".\r\n    \r\n         --remote-client hostname\r\n                                Host name / IP address of remote server.  Used to\r\n                                backup a remote server to local host.\r\n    \r\n         --backup-server hostname\r\n                                Host name / IP address of backup server.  Used to\r\n                                backup to a remote server.\r\n    \r\n     -f, --force-full           Force a full backup\r\n    \r\n     -C, --changedir path       Changes to the given directory path before\r\n                                backing up or restoring.\r\n    \r\n         --graft /path/name/=/new/name/\r\n                                Re-write path names beginning with \"/path/name/\"\r\n                                to \"/new/name/\"\r\n    \r\n         --plugin scriptname    Specifies an optional plug in script.  Usually\r\n                                used to perform database-specific operations\r\n                                (such as enabling hot backup mode) for systems\r\n                                with a DB installed.\r\n    \r\n     [ file-list ]              List of files to backup -- overrides default\r\n\r\n### snebu-client restore\r\n    Usage: snebu-client restore [ -n backupname ] [ -d datestamp ] [ file-list ]\r\n     Restores a given backup session identified by \"-n\" and \"-d\"\r\n     parameters.  Use the \"listbackups\" subcommand to get a list of\r\n     available backup sessions.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu-client.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n    \r\n     -C, --changedir path       Changes to the given directory path before\r\n                                backing up or restoring.\r\n    \r\n         --remote-client hostname\r\n                                Host name / IP address of remote server.  Used to\r\n                                backup a remote server to local host.\r\n    \r\n         --backup-server hostname\r\n                                Host name / IP address of backup server.  Used to\r\n                                backup to a remote server.\r\n    \r\n     [ file-list ]              List of files to restore.  Defaults to all.\r\n\r\n### snebu-client listbackups\r\n    Usage: snebu-client listbackups [ -n hostname [ -d datestamp ]] [ file_list... ]\r\n     With no arguments specified, \"listbackups\" will return a list of all\r\n     systems that are contained in the backup catalog.  Otherwise, when\r\n     specifying the -n parameter, a list of backup sets for that host is\r\n     returned.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu-client.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n\r\nsnebu\r\n----\r\n\r\n    Usage: snebu [ subcommand ] [ options ]\r\n      where \"subcommand\" is one of the following:\r\n        newbackup -n backupname -d datestamp -r schedule\r\n    \r\n        submitfiles -n backupname -d datestamp\r\n    \r\n        restore -n backupname -d datestamp [ file_list... ]\r\n    \r\n        listbackups [ -n hostname [ -d datestamp ]] [ file_list... ]\r\n    \r\n        expire [ -n hostname -d datestamp ] or [ -a days -r schedule [ -n hostname ]]\r\n    \r\n        purge\r\n    \r\n        help [ subcommand ]\r\n    \r\n     The \"snebu\" command is a backup tool which manages storing data from\r\n     backup sessions on disk-based storage, utilizing a simple database\r\n     for tracking backup sets and meta data.  Typically it is called via a\r\n     front end script (such as the included \"snebu-client\" shell script). \r\n     Documentation is provided here if you need to create a custom backup\r\n     client script.  The subcommands are listed below along with the most\r\n     common options.  Details on each command are given in each command's\r\n     help section.\r\n\r\n### snebu newbackup\r\n    Usage: snebu newbackup -n backupname -d datestamp -r schedule\r\n     The \"newbackup\" command creates a new backup set, by consuming a\r\n     tab-delimited list of file names (along with associated meta data) to\r\n     include in the backup.  It then compares this list to the backup\r\n     catalog database to determine which files are new, and which ones are\r\n     already contained on the backup media.  A list of new / changed files\r\n     is returned, which can then be passed along to \"tar\" to generate a\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n    \r\n     -r, --retention schedule   Retention schedule for this backup set.  Typical\r\n                                values are \"daily\", \"weekly\", \"monthly\", \"yearly\".\r\n    \r\n     -T, --files-from FILE      Read list of filenames (with meta data) to backup\r\n                                from the named file, instead of standard input.\r\n    \r\n         --null                 Inbound file backup list (-T, or standard input)\r\n                                is null terminated\r\n    \r\n         --not-null             Inbound file backup list (-T, or standard input)\r\n                                is newline terminated\r\n    \r\n         --null-output          Generate include-file-list with null terminated\r\n                                lines.\r\n    \r\n         --not-null-output      Generate include-file-list with newline\r\n                                terminated lines.\r\n    \r\n     -f, --force-full           Force a full backup\r\n    \r\n         --graft /path/name/=/new/name/ \r\n                                Re-write path names beginning with \"/path/name/\"\r\n                                to \"/new/name/\"\r\n    \r\n     -v,                        Verbose output\r\n\r\n### snebu submitfiles\r\n    Usage: snebu submitfiles -n backupname -d datestamp\r\n     The \"submitfiles\" command is called after newbackup, and is used to\r\n     submit a tar file containing the list of filest that newbackup\r\n     returned.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n    \r\n     -v,                        Verbose output\r\n\r\n### snebu restore\r\n    Usage: snebu restore -n backupname -d datestamp [ file_list... ]\r\n     Generates a tar file containing files from a given backup set.  Pipe\r\n     the output of this command into a tar command to actually restore\r\n     files.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n         --graft /path/name/=/new/name/ \r\n                                Re-write path names beginning with \"/path/name/\"\r\n                                to \"/new/name/\"\r\n\r\n### snebu listbackups\r\n    Usage: snebu listbackups [ -n hostname [ -d datestamp ]] [ file_list... ]\r\n     With no arguments specified, \"listbackups\" will return a list of all\r\n     systems that are contained in the backup catalog.  Otherwise, when\r\n     specifying the -n parameter, a list of backup sets for that host is\r\n     returned.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n\r\n### snebu expire\r\n    Usage: snebu expire [ -n hostname -d datestamp ] or [ -a days -r schedule [ -n hostname ]]\r\n     Removes backup sessions from the snebu backup catalog database.  A\r\n     specific backup session can be purged by providing the \"-n\" and \"-d\"\r\n     options, or all backups that are part of a given retention schedule\r\n     (specified with \"-r\", and optionally from a given host, with the \"-n\"\r\n     option) that are older than a given number of days (\"-a\") are removed.\r\n    \r\n    Options:\r\n     -c, --config config_file   Name of the configuration file.  Default is\r\n                                /etc/snebu.conf.\r\n    \r\n     -n, --name backupname      Name of the backup.  Usually set to the server\r\n                                name that you are backing up.\r\n    \r\n     -d, --date datestamp       Date stamp for this backup set.  The format is in\r\n                                time_t format, sames as the output of the \"date\r\n                                +%s\" command.\r\n    \r\n     -r, --retention schedule   Retention schedule for this backup set.  Typical\r\n                                values are \"daily\", \"weekly\", \"monthly\", \"yearly\".\r\n     -a, --age #days            Expire backups older than #days.\r\n    \r\n     -m, --min-keep #           When expiring with the \"-a\" flag, keep at least\r\n                                this many of the most recent backups for a given\r\n                                hostname/retention level.\r\n\r\n### snebu purge\r\n    Usage: snebu purge\r\n     Permanently removes files from disk storage that are no longer\r\n     referenced by any backups. Run this command after running \"snebu\r\n     expire\".\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}